var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=_default;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=require("react");var _app=_interopRequireDefault(require("firebase/app"));function _default(props){var _useState=(0,_react.useState)('loading'),_useState2=(0,_slicedToArray2.default)(_useState,2),user=_useState2[0],setUser=_useState2[1];var displayName=props.displayName,photoURL=props.photoURL;(0,_react.useEffect)(function(){var unsubcribe=_app.default.auth().onIdTokenChanged(function(u){if(props.beforeAuthUpdate)props.beforeAuthUpdate(u);setUser(u);});return unsubcribe;},[]);(0,_react.useEffect)(function(){var start=function start(){var _firebase$auth,currentUser;return _regenerator.default.async(function start$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(!props.AuthComponent||props.signInAnonymously)){_context.next=18;break;}_context.next=4;return _regenerator.default.awrap(_app.default.auth().signInAnonymously());case 4:_firebase$auth=_app.default.auth(),currentUser=_firebase$auth.currentUser;if(!(displayName||currentUser)){_context.next=18;break;}if(photoURL){_context.next=11;break;}_context.next=9;return _regenerator.default.awrap(currentUser.updateProfile({displayName:displayName}));case 9:_context.next=18;break;case 11:if(displayName){_context.next=16;break;}_context.next=14;return _regenerator.default.awrap(currentUser.updateProfile({photoURL:photoURL}));case 14:_context.next=18;break;case 16:_context.next=18;return _regenerator.default.awrap(currentUser.updateProfile({photoURL:photoURL,displayName:displayName}));case 18:_context.next=23;break;case 20:_context.prev=20;_context.t0=_context["catch"](0);console.error('fuego AuthGate sign in error',_context.t0);case 23:case"end":return _context.stop();}}},null,null,[[0,20]]);};start();},[props.signInAnonymously,displayName,photoURL,props.AuthComponent]);return{};}
//# sourceMappingURL=index.js.map