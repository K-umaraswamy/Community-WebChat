var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _reactNative=require("react-native");var MEMORY_KEY_PREFIX='@MyStorage:';var dataMemory={};var MyStorage=function(){function MyStorage(){(0,_classCallCheck2.default)(this,MyStorage);}(0,_createClass2.default)(MyStorage,null,[{key:"setItem",value:function setItem(key,value){_reactNative.AsyncStorage.setItem(MEMORY_KEY_PREFIX+key,value);dataMemory[key]=value;return dataMemory[key];}},{key:"getItem",value:function getItem(key){return Object.prototype.hasOwnProperty.call(dataMemory,key)?dataMemory[key]:undefined;}},{key:"removeItem",value:function removeItem(key){_reactNative.AsyncStorage.removeItem(MEMORY_KEY_PREFIX+key);return delete dataMemory[key];}},{key:"clear",value:function clear(){dataMemory={};return dataMemory;}},{key:"sync",value:function sync(){if(!MemoryStorage.syncPromise){MemoryStorage.syncPromise=new Promise(function(res,rej){_reactNative.AsyncStorage.getAllKeys(function(errKeys,keys){if(errKeys)rej(errKeys);var memoryKeys=keys.filter(function(key){return key.startsWith(MEMORY_KEY_PREFIX);});_reactNative.AsyncStorage.multiGet(memoryKeys,function(err,stores){if(err)rej(err);stores.map(function(result,index,store){var key=store[index][0];var value=store[index][1];var memoryKey=key.replace(MEMORY_KEY_PREFIX,'');dataMemory[memoryKey]=value;});res();});});});}return MemoryStorage.syncPromise;}}]);return MyStorage;}();MyStorage.syncPromise=null;
//# sourceMappingURL=Storage.js.map