import _classCallCheck from"@babel/runtime/helpers/classCallCheck";import _createClass from"@babel/runtime/helpers/createClass";import{AsyncStorage}from'react-native';var MEMORY_KEY_PREFIX='@MyStorage:';var dataMemory={};var MyStorage=function(){function MyStorage(){_classCallCheck(this,MyStorage);}_createClass(MyStorage,null,[{key:"setItem",value:function setItem(key,value){AsyncStorage.setItem(MEMORY_KEY_PREFIX+key,value);dataMemory[key]=value;return dataMemory[key];}},{key:"getItem",value:function getItem(key){return Object.prototype.hasOwnProperty.call(dataMemory,key)?dataMemory[key]:undefined;}},{key:"removeItem",value:function removeItem(key){AsyncStorage.removeItem(MEMORY_KEY_PREFIX+key);return delete dataMemory[key];}},{key:"clear",value:function clear(){dataMemory={};return dataMemory;}},{key:"sync",value:function sync(){if(!MemoryStorage.syncPromise){MemoryStorage.syncPromise=new Promise(function(res,rej){AsyncStorage.getAllKeys(function(errKeys,keys){if(errKeys)rej(errKeys);var memoryKeys=keys.filter(function(key){return key.startsWith(MEMORY_KEY_PREFIX);});AsyncStorage.multiGet(memoryKeys,function(err,stores){if(err)rej(err);stores.map(function(result,index,store){var key=store[index][0];var value=store[index][1];var memoryKey=key.replace(MEMORY_KEY_PREFIX,'');dataMemory[memoryKey]=value;});res();});});});}return MemoryStorage.syncPromise;}}]);return MyStorage;}();MyStorage.syncPromise=null;
//# sourceMappingURL=Storage.js.map