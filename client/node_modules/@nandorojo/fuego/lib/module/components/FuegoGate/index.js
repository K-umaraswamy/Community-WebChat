import _extends from"@babel/runtime/helpers/extends";import _regeneratorRuntime from"@babel/runtime/regenerator";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";var _jsxFileName="/Users/Fernando/Developer/Learning Babel/fuego/src/components/FuegoGate/index.tsx";import React,{useEffect,useState}from'react';import useFuegoContext from'../../hooks/useFuegoContext';var AuthGate=function AuthGate(props){var LoadingComponent=props.LoadingComponent,displayName=props.displayName,photoURL=props.photoURL;var _useState=useState('loading'),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var context=useFuegoContext();var auth=context.auth;useEffect(function(){var unsubcribe=auth().onIdTokenChanged(function(u){if(props.beforeAuthUpdate)props.beforeAuthUpdate(u);setUser(u);});return unsubcribe;},[]);useEffect(function(){var start=function start(){var _auth,currentUser;return _regeneratorRuntime.async(function start$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(!props.AuthComponent&&props.signInAnonymously)){_context.next=18;break;}_context.next=4;return _regeneratorRuntime.awrap(auth().signInAnonymously());case 4:_auth=auth(),currentUser=_auth.currentUser;if(!(displayName||currentUser)){_context.next=18;break;}if(photoURL){_context.next=11;break;}_context.next=9;return _regeneratorRuntime.awrap(currentUser.updateProfile({displayName:displayName}));case 9:_context.next=18;break;case 11:if(displayName){_context.next=16;break;}_context.next=14;return _regeneratorRuntime.awrap(currentUser.updateProfile({photoURL:photoURL}));case 14:_context.next=18;break;case 16:_context.next=18;return _regeneratorRuntime.awrap(currentUser.updateProfile({photoURL:photoURL,displayName:displayName}));case 18:_context.next=23;break;case 20:_context.prev=20;_context.t0=_context["catch"](0);console.error('fuego AuthGate sign in error',_context.t0);case 23:case"end":return _context.stop();}}},null,null,[[0,20]]);};start();},[props.signInAnonymously,props.displayName,props.photoURL,props.AuthComponent]);if(user==='loading')return LoadingComponent?React.createElement(LoadingComponent,{__source:{fileName:_jsxFileName,lineNumber:61}}):null;if(!user&&props.AuthComponent){var AuthComponent=props.AuthComponent;return React.createElement(AuthComponent,_extends({},context,props,{__source:{fileName:_jsxFileName,lineNumber:66}}));}return React.createElement(React.Fragment,null,props.children);};export default AuthGate;
//# sourceMappingURL=index.js.map