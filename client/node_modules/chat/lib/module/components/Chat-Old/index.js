import _defineProperty from"@babel/runtime/helpers/defineProperty";import _extends from"@babel/runtime/helpers/extends";var _jsxFileName="/Users/Fernando/Developer/Learning Babel/usechat/src/components/Chat-Old/index.tsx";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useMemo,useRef,useEffect,useCallback}from'react';import{SafeAreaView,View,StyleSheet,Animated}from'react-native';import{Transitioning,Transition}from'react-native-reanimated';import Message from'./Message';import Composer from'./Composer';import SystemMessage from'./SystemMessage';function Chat(props,ref){var inputRef=useRef();var flatListRef=useRef();var componentRef=useRef();if(!componentRef.current){componentRef.current={focusInput:function focusInput(){return inputRef.current&&inputRef.current.focus();},blurInput:function blurInput(){return inputRef.current&&inputRef.current.blur();},scrollToEnd:function scrollToEnd(){return flatListRef.current&&flatListRef.current.scrollToEnd();},scrollToIndex:function scrollToIndex(params){return flatListRef.current&&flatListRef.current.scrollToIndex(params);},scrollToItem:function scrollToItem(params){return flatListRef.current&&flatListRef.current.scrollToItem(params);},scrollToOffset:function scrollToOffset(params){return flatListRef.current&&flatListRef.current.scrollToOffset(params);}};if(ref)ref.current=componentRef.current;}var transitionRef=useRef(null);var mounted=useRef(false);var scrollY=useMemo(function(){return props.animatedScrollNode||new Animated.Value(0);},[props.animatedScrollNode]);var onScroll=Animated.event([{nativeEvent:{contentOffset:{y:scrollY}}}],{useNativeDriver:true});useEffect(function(){if(flatListRef.current){var iSentLastMessage=props.messages[0]&&props.messages[0].user&&props.messages[0].user.id===props.user.id;if(iSentLastMessage&&!props.disableScrollToBottomOnSend)flatListRef.current.scrollToOffset({offset:0});else if(props.scrollToBottomOnAllNewMessages)flatListRef.current.scrollToOffset({offset:0});}},[props.disableScrollToBottomOnSend,props.scrollToBottomOnAllNewMessages,props.messages,props.user.id]);var onViewableItemsChangedRef=useRef(props.onViewableItemsChanged);var onViewMessagesRef=useRef(props.onViewMessages);var messagesRef=useRef(props.messages);useEffect(function(){onViewableItemsChangedRef.current=props.onViewableItemsChanged;onViewMessagesRef.current=props.onViewMessages;messagesRef.current=props.messages;},[props.onViewableItemsChanged,props.onViewMessages,props.messages]);var onViewableItemsChanged=useCallback(function(info){if(onViewableItemsChangedRef.current)onViewableItemsChangedRef.current(info);if(onViewMessagesRef.current){var visibleMessages=info.viewableItems.filter(function(i){return i.isViewable;}).map(function(i){return i.item;});var latestMessageId=messagesRef.current&&messagesRef.current[0]&&messagesRef.current[0].id;onViewMessagesRef.current({visibleMessages:visibleMessages,latestMessageId:latestMessageId});}},[]);useEffect(function(){if(!props.disableTransitions&&(mounted.current||!props.disableTransitionOnMount)&&transitionRef.current)transitionRef.current.animateNextTransition();else mounted.current=true;},[props.disableTransitionOnMount,props.namesOfUsersTyping,props.messages,props.disableTransitions]);var renderItem=function renderItem(info){if(props.renderItem)return props.renderItem(info);if(props.renderMessage===null)return null;var message=info.item,index=info.index;if(message.system){var systemProps={text:message.text,createdAt:message.createdAt,textStyle:props.systemMessageTextStyle,containerStyle:props.systemMessageContainerStyle,dateToStringFunc:props.systemMessageDateToStringFunc,dateStyle:props.systemMessageDateStyle};if(props.renderSystemMessage===null)return null;if(props.renderSystemMessage)return props.renderSystemMessage(systemProps);return React.createElement(SystemMessage,_extends({},systemProps,{__source:{fileName:_jsxFileName,lineNumber:174}}));}var isMe=message.user.id===props.user.id;var messageCreatesNewBunch=!(props.messages[index+1]&&props.messages[index+1].user&&props.messages[index+1].user.id===(props.user&&props.user.id));var showName=!isMe&&messageCreatesNewBunch;var showAvatar=props.showAvatarForEveryMessage||messageCreatesNewBunch;if(isMe&&props.hideMyAvatar)showAvatar=false;var bubbleStyle=props.bubbleStyle&&props.bubbleStyle[isMe?'me':'others'];var messageContainerStyle=props.messageContainerStyle&&props.messageContainerStyle[isMe?'me':'others'];var bubbleTextStyle=props.bubbleTextStyle&&props.bubbleTextStyle[isMe?'me':'others'];var messageWrapperStyle=props.messageWrapperStyle&&props.messageWrapperStyle[isMe?'me':'others'];var messageProps={messageContainerStyle:messageContainerStyle,bubbleStyle:bubbleStyle,bubbleTextStyle:bubbleTextStyle,messageWrapperStyle:messageWrapperStyle,delivered:true,isMe:message.user.id===props.user.id,renderFooter:props.renderMessageFooter,imageProps:props.imageProps,media:message.media,name:message.user.name,system:message.system,text:message.text,read:true,renderMedia:props.renderMessageMedia,onLongPress:props.onLongPressMessage,onPress:props.onPressMessage,pressType:props.messagePressType||'double',doubleTapDelay:props.messageDoubleTapDelay,disableSwipeActions:props.disableSwipeActions,swipeActions:props.swipeActions,longPressDelay:props.messageLongPressDelay,id:message.id,showName:showName,avatar:message.user.avatar,avatarImageProps:props.avatarImageProps,avatarSize:props.avatarSize,renderAvatar:props.renderAvatar,showAvatar:showAvatar,initialsBackgroundColor:props.initialsBackgroundColor,initialsTextColor:props.initialsTextColor,renderInitials:props.renderInitials};if(props.renderMessage)return props.renderMessage(messageProps);return React.createElement(Message,_extends({},messageProps,{__source:{fileName:_jsxFileName,lineNumber:240}}));};var keyExtractor=useMemo(function(){return props.keyExtractor||function(_ref){var id=_ref.id;return id;};},[props.keyExtractor]);var renderList=function renderList(){return React.createElement(Animated.FlatList,_extends({},props.flatListProps,{ref:flatListRef,data:props.messages,keyExtractor:keyExtractor,renderItem:renderItem,extraData:props.extraData,ListHeaderComponent:props.ListFooterComponent,inverted:true,onScroll:onScroll,onViewableItemsChanged:onViewableItemsChanged,keyboardShouldPeristTaps:props.keyboardShouldPersistTaps||'handled',keyboardDismissMode:props.keyboardDismissMode||'interactive',contentContainerStyle:_objectSpread({},styles.contentContainer,{},props.contentContainerStyle||{}),__source:{fileName:_jsxFileName,lineNumber:250}}));};var renderHeader=function renderHeader(){if(props.renderHeader)return props.renderHeader();return null;};var renderFooter=function renderFooter(){if(props.renderFooter)return props.renderFooter();return null;};var renderComposer=function renderComposer(){if(props.renderComposer===null)return null;var composerProps={onInputTextChanged:props.onInputTextChanged,text:props.text,initialText:props.initialText,placeholderColor:props.placeholderColor,placeholderText:props.placeholderText,renderSendButton:props.renderSendButton,renderTextInput:props.renderTextInput,textInputProps:props.textInputProps,media:props.media,onChangeMedia:props.onChangeMedia,user:props.user,onSend:props.onSend,sendButtonMode:props.sendButtonMode,containerStyle:props.composerContainerStyle,inputContainerStyle:props.inputContainerStyle,inputStyle:props.inputStyle,tintColor:props.tintColor,inputRef:inputRef};if(props.renderComposer)return props.renderComposer(composerProps);return React.createElement(Composer,_extends({},composerProps,{__source:{fileName:_jsxFileName,lineNumber:303}}));};var Container=props.ContainerComponent||(props.safeArea?SafeAreaView:View);var transition=useMemo(function(){return props.transitionConfig||React.createElement(Transition.Sequence,{__source:{fileName:_jsxFileName,lineNumber:314}},React.createElement(Transition.Together,{__source:{fileName:_jsxFileName,lineNumber:315}},React.createElement(Transition.Out,{type:"fade",__source:{fileName:_jsxFileName,lineNumber:316}}),React.createElement(Transition.Change,{interpolation:"easeOut",__source:{fileName:_jsxFileName,lineNumber:317}})),React.createElement(Transition.In,{type:"fade",__source:{fileName:_jsxFileName,lineNumber:319}}));},[props.transitionConfig]);var containerStyle=useMemo(function(){return _objectSpread({},styles.container,{},props.containerStyle);},[props.containerStyle]);return React.createElement(Transitioning.View,{ref:transitionRef,transition:transition,style:containerStyle,__source:{fileName:_jsxFileName,lineNumber:332}},React.createElement(Container,{style:containerStyle,__source:{fileName:_jsxFileName,lineNumber:337}},renderHeader(),renderList(),renderFooter(),renderComposer()));}export default Chat;var styles=StyleSheet.create({container:{flex:1},contentContainer:{flexGrow:1}});
//# sourceMappingURL=index.js.map