{"version":3,"sources":["index.tsx"],"names":["React","useCallback","useRef","useMemo","useEffect","View","StyleSheet","Text","Bubble","Avatar","Initials","getInitials","Transitioning","Transition","Touchable","Message","props","bubble","transitionRef","mounted","renderAvatar","avatar","avatarImageProps","showAvatar","name","renderInitials","initialsBackgroundColor","initialsTextColor","current","animateNextTransition","text","renderFooter","footer","id","containerStyle","styles","container","isMe","meStyles","otherStyles","messageContainerStyle","wrapperStyle","wrapper","messageWrapperStyle","avatarSize","maybeRenderName","style","showName","nameStyle","renderAvatarOrInitials","opacity","size","avatarProps","imageProps","ImageComponent","AvatarImageComponent","initialsProps","initials","textColor","backgroundColor","tintColor","bubbleBackgroundColor","userId","userName","createdAt","system","fallback","colors","Array","isArray","background","user","length","console","warn","renderBubble","bubbleStyle","bubbleTextStyle","bubbleTextColor","mediaContentType","mediaHeight","mediaWidth","mediaUri","mediaUrl","renderMedia","renderText","outerStyle","createsNewBunch","marginTop","longPressDelay","doubleTapDelay","onDoubleTap","onPress","onLongPress","transition","flex","justifyContent","AvatarContainer","memo","children","displayName","create","outer","alignItems","paddingHorizontal","marginHorizontal","fontSize","color","paddingVertical","flexDirection","textAlign"],"mappings":"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","sourcesContent":["import React, {\n\tuseCallback,\n\tuseRef,\n\tMutableRefObject,\n\tuseMemo,\n\tFunctionComponent,\n\tuseEffect,\n\tRefObject,\n} from 'react'\nimport { View, StyleSheet, Text } from 'react-native'\nimport { MessageProps } from '../types'\nimport { NewMessageModel } from '../../../classes/Message/types'\n// import { NewMessageModel } from '../../../classes/Message/types'\nimport Bubble from '../Bubble'\nimport { Avatar, Initials } from '../../index'\nimport { InitialsProps, AvatarProps } from '../../../components/Inbox/types'\n// TODO update imports for these\nimport { getInitials } from '../../../helpers/getInitials'\nimport {\n\tTransitioning,\n\tTransitioningView,\n\tTransition,\n} from 'react-native-reanimated'\nimport Touchable from './Touchable'\n// import { AvatarProps, InitialsProps } from '../../Inbox/types'\n// import { getInitials } from '../../../helpers/getInitials'\n\nconst Message = <Model extends NewMessageModel = NewMessageModel>(\n\tprops: MessageProps<Model>\n) => {\n\tconst bubble = useRef<View>()\n\tconst transitionRef = useRef<TransitioningView>()\n\tconst mounted = useRef(false)\n\n\tconst {\n\t\trenderAvatar,\n\t\tavatar,\n\t\tavatarImageProps,\n\t\tshowAvatar,\n\t\tname,\n\t\trenderInitials,\n\t\tinitialsBackgroundColor,\n\t\tinitialsTextColor,\n\t} = props\n\n\tuseEffect(() => {\n\t\tif (mounted.current) {\n\t\t\t// console.log('message updated', props.text)\n\t\t\ttransitionRef.current && transitionRef.current.animateNextTransition()\n\t\t} else {\n\t\t\tmounted.current = true\n\t\t}\n\t}, [props.avatar, props.text, renderAvatar])\n\n\tconst { renderFooter } = props\n\n\tconst footer = useCallback(\n\t\t() => (renderFooter ? renderFooter({ id: props.id }) : null),\n\t\t[props.id, renderFooter]\n\t)\n\n\tconst containerStyle = useMemo(() => {\n\t\treturn [\n\t\t\tstyles.container,\n\t\t\tprops.isMe ? meStyles.container : otherStyles.container,\n\t\t\tprops.messageContainerStyle,\n\t\t]\n\t}, [props.isMe, props.messageContainerStyle])\n\n\tconst wrapperStyle = useMemo(() => {\n\t\treturn [\n\t\t\tstyles.wrapper,\n\t\t\tprops.isMe ? meStyles.wrapper : otherStyles.wrapper,\n\t\t\tprops.messageWrapperStyle,\n\t\t]\n\t}, [props.isMe, props.messageWrapperStyle])\n\n\t// no avatar size if it's rendered null. this var is used in different spots\n\tconst avatarSize = renderAvatar === null ? 0 : props.avatarSize || 35\n\n\tconst maybeRenderName = useCallback(() => {\n\t\tconst style = {\n\t\t\t...styles.name,\n\t\t\t...(props.isMe ? meStyles.name : otherStyles.name),\n\t\t}\n\t\treturn props.showName && props.name ? (\n\t\t\t<Text style={[style, props.nameStyle]}>{props.name}</Text>\n\t\t) : null\n\t}, [props.showName, props.name, props.nameStyle, props.isMe])\n\n\tconst renderAvatarOrInitials = useCallback(() => {\n\t\tif (renderAvatar === null) return null\n\t\t// we make opacity 0 instead of hiding it to maintain the same width from the side\n\t\tconst opacity = showAvatar === false ? 0 : 1\n\t\tconst size = avatarSize\n\n\t\tif (avatar) {\n\t\t\tconst avatarProps: AvatarProps = {\n\t\t\t\tavatar: avatar,\n\t\t\t\timageProps: avatarImageProps,\n\t\t\t\tsize,\n\t\t\t\tImageComponent: props.AvatarImageComponent,\n\t\t\t}\n\t\t\tif (renderAvatar) return renderAvatar(avatarProps)\n\t\t\treturn (\n\t\t\t\t<AvatarContainer opacity={opacity} showAvatar={!!showAvatar}>\n\t\t\t\t\t<Avatar {...avatarProps} />\n\t\t\t\t</AvatarContainer>\n\t\t\t)\n\t\t}\n\t\tconst initialsProps: InitialsProps = {\n\t\t\tinitials: getInitials(name),\n\t\t\tsize,\n\t\t\ttextColor: initialsTextColor,\n\t\t\tbackgroundColor: initialsBackgroundColor || props.tintColor,\n\t\t}\n\t\tif (renderInitials) return renderInitials(initialsProps)\n\t\treturn (\n\t\t\t<AvatarContainer opacity={opacity} showAvatar={!!showAvatar}>\n\t\t\t\t<Initials {...initialsProps} />\n\t\t\t</AvatarContainer>\n\t\t)\n\t}, [\n\t\tavatar,\n\t\tavatarImageProps,\n\t\tavatarSize,\n\t\trenderAvatar,\n\t\tshowAvatar,\n\t\tname,\n\t\trenderInitials,\n\t\tinitialsBackgroundColor,\n\t\tinitialsTextColor,\n\t\tprops.tintColor,\n\t\tprops.AvatarImageComponent,\n\t])\n\n\tconst {\n\t\tbubbleBackgroundColor,\n\t\tid,\n\t\tuserId,\n\t\tuserName,\n\t\tcreatedAt,\n\t\ttext,\n\t\tsystem,\n\t} = props\n\tconst backgroundColor = useMemo(() => {\n\t\tconst fallback = props.isMe\n\t\t\t? ['#7B16FF', '#7114EA']\n\t\t\t: ['#f1f7f8', '#f8f8f8']\n\t\tif (!bubbleBackgroundColor) return fallback\n\t\tlet colors: string[] = []\n\t\tif (typeof bubbleBackgroundColor === 'string') {\n\t\t\tcolors = [bubbleBackgroundColor, bubbleBackgroundColor]\n\t\t} else if (Array.isArray(bubbleBackgroundColor)) {\n\t\t\tcolors = bubbleBackgroundColor\n\t\t} else if (typeof bubbleBackgroundColor === 'function') {\n\t\t\tconst background = bubbleBackgroundColor({\n\t\t\t\tcreatedAt,\n\t\t\t\tid,\n\t\t\t\tuser: {\n\t\t\t\t\tname: userName ?? '',\n\t\t\t\t\tid: userId ?? '',\n\t\t\t\t\tavatar: avatar ?? '',\n\t\t\t\t},\n\t\t\t\ttext,\n\t\t\t\tsystem,\n\t\t\t})\n\t\t\t// const background = bubbleBackgroundColor({\n\t\t\t// \tuser: {\n\t\t\t// \t\tavatar: props.avatar || '',\n\t\t\t// \t\tid: props.userId || '',\n\t\t\t// \t\tname: props.userName || '',\n\t\t\t// \t},\n\t\t\t// \tid: props.id,\n\t\t\t// })\n\t\t\tif (Array.isArray(background)) {\n\t\t\t\tcolors = background\n\t\t\t} else if (typeof background === 'string') {\n\t\t\t\tcolors = [background, background]\n\t\t\t}\n\t\t}\n\t\tif (!colors.length) {\n\t\t\tconsole.warn(\n\t\t\t\t`🍇 Juice.Chat issue: It looks like you tried to set the message bubble background color, but something was off, so we're using the default colors. You should be passing either a string, array, or function to the bubbleBackgroundColor, like this: bubbleBackgroundColor={{ ${\n\t\t\t\t\tprops.isMe ? 'me' : 'others'\n\t\t\t\t}: 'blue' }}. Instead, you passed this: ${bubbleBackgroundColor}.`\n\t\t\t)\n\t\t\treturn fallback\n\t\t}\n\t\treturn colors\n\t}, [\n\t\tprops.isMe,\n\t\tbubbleBackgroundColor,\n\t\tcreatedAt,\n\t\tid,\n\t\tuserName,\n\t\tuserId,\n\t\tavatar,\n\t\ttext,\n\t\tsystem,\n\t])\n\tconst renderBubble = () => {\n\t\treturn (\n\t\t\t<Bubble\n\t\t\t\ttext={props.text}\n\t\t\t\tisMe={props.isMe}\n\t\t\t\tstyle={props.bubbleStyle}\n\t\t\t\ttextStyle={props.bubbleTextStyle}\n\t\t\t\tbubbleRef={bubble as MutableRefObject<View>}\n\t\t\t\tbackgroundColor={backgroundColor}\n\t\t\t\ttextColor={props.bubbleTextColor}\n\t\t\t\tmediaContentType={props.mediaContentType}\n\t\t\t\tmediaHeight={props.mediaHeight}\n\t\t\t\tmediaWidth={props.mediaWidth}\n\t\t\t\tmediaUri={props.mediaUri}\n\t\t\t\tmediaUrl={props.mediaUrl}\n\t\t\t\trenderMedia={props.renderMedia}\n\t\t\t\trenderText={props.renderText}\n\t\t\t/>\n\t\t)\n\t}\n\tconst outerStyle = useMemo(\n\t\t() => (props.createsNewBunch ? { marginTop: 10 } : {}),\n\t\t[props.createsNewBunch]\n\t)\n\treturn (\n\t\t<Touchable\n\t\t\tid={props.id}\n\t\t\tlongPressDelay={props.longPressDelay}\n\t\t\tdoubleTapDelay={props.doubleTapDelay}\n\t\t\tonDoubleTap={props.onDoubleTap}\n\t\t\tonPress={props.onPress}\n\t\t\tonLongPress={props.onLongPress}\n\t\t>\n\t\t\t<Transitioning.View\n\t\t\t\tstyle={outerStyle}\n\t\t\t\ttransition={transition}\n\t\t\t\tref={transitionRef as RefObject<TransitioningView>}\n\t\t\t>\n\t\t\t\t<View style={containerStyle}>\n\t\t\t\t\t<View style={wrapperStyle}>\n\t\t\t\t\t\t{renderAvatarOrInitials()}\n\t\t\t\t\t\t<View style={{ flex: 1, justifyContent: 'flex-start' }}>\n\t\t\t\t\t\t\t{maybeRenderName()}\n\t\t\t\t\t\t\t<View style={wrapperStyle}>{renderBubble()}</View>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t\t{footer()}\n\t\t\t\t</View>\n\t\t\t</Transitioning.View>\n\t\t</Touchable>\n\t)\n}\n\nconst transition = (\n\t// <Transition.Sequence>\n\t// {/* <Transition.Out type=\"fade\" /> */}\n\t<Transition.Together>\n\t\t<Transition.Change interpolation=\"easeOut\" />\n\t\t<Transition.In type=\"fade\" />\n\t</Transition.Together>\n\t// </Transition.Sequence>\n)\n\nconst AvatarContainer: FunctionComponent<{\n\tshowAvatar: boolean\n\topacity: 0 | 1\n}> = React.memo(function AvatarContainer({ children, opacity }) {\n\treturn (\n\t\t<View\n\t\t\tstyle={{\n\t\t\t\topacity,\n\t\t\t\t// transform: [{ rotate: !showAvatar ? '180deg' : '0deg' }],\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</View>\n\t)\n})\n\nMessage.displayName = 'Message'\n\nexport default React.memo(Message)\n\nconst styles = StyleSheet.create({\n\touter: {},\n\tcontainer: {\n\t\tmarginTop: 1,\n\t\talignItems: 'flex-end',\n\t\tpaddingHorizontal: 10,\n\t},\n\t// wrapper is concerned with which side the avatar is on relative to the bubble\n\twrapper: {\n\t\tflex: 1,\n\t\talignItems: 'flex-end',\n\t\tjustifyContent: 'flex-start',\n\t},\n\tname: {\n\t\tmarginHorizontal: 10,\n\t\tfontSize: 14,\n\t\tcolor: 'gray',\n\t\tpaddingVertical: 5,\n\t},\n})\n\nconst meStyles = StyleSheet.create({\n\tcontainer: {\n\t\tjustifyContent: 'flex-end',\n\t},\n\twrapper: {\n\t\tflexDirection: 'row-reverse',\n\t},\n\tname: {\n\t\ttextAlign: 'right',\n\t},\n})\n\nconst otherStyles = StyleSheet.create({\n\tcontainer: {\n\t\tjustifyContent: 'flex-end',\n\t},\n\twrapper: {\n\t\tflexDirection: 'row',\n\t},\n\tname: {\n\t\ttextAlign: 'left',\n\t},\n})\n"]}