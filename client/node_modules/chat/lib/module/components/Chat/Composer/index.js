import _extends from"@babel/runtime/helpers/extends";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";var _jsxFileName="/Users/Fernando/Developer/Learning Babel/usechat/src/components/Chat/Composer/index.tsx";import React,{useState,useCallback,useMemo,useEffect}from'react';import uuid from'uuid';import{View,StyleSheet,Keyboard}from'react-native';import{isIphoneX,getBottomSpace}from'react-native-iphone-x-helper';import Input from'./Input';import Send from'./Send';var Composer=function Composer(props){var _ref2;var _useState=useState(props.initialText||''),_useState2=_slicedToArray(_useState,2),textState=_useState2[0],setText=_useState2[1];var _useMemo=useMemo(function(){return[props.text!==undefined?props.text:textState,props.text!==undefined?props.onInputTextChanged:setText];},[props.text,textState,props.onInputTextChanged]),_useMemo2=_slicedToArray(_useMemo,2),text=_useMemo2[0],onChangeText=_useMemo2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),mediaState=_useState4[0],setMedia=_useState4[1];var _ref=[props.media||mediaState,props.media&&props.onChangeMedia||setMedia],media=_ref[0],onChangeMedia=_ref[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),keyboardOpen=_useState6[0],setKeyboardOpen=_useState6[1];useEffect(function(){var show=function show(){setKeyboardOpen(true);};var hide=function hide(){setKeyboardOpen(false);};Keyboard.addListener('keyboardWillShow',show);Keyboard.addListener('keyboardWillHide',hide);return function(){Keyboard.removeListener('keyboardWillShow',show);Keyboard.removeListener('keyboardWillHide',hide);};},[]);var user=props.user;var messagesReadyToSend=useMemo(function(){var messages=[];if(media&&media.length){;media.forEach(function(item){var message={user:user,text:'',id:uuid.v4(),createdAt:new Date(),media:item};messages.push(message);});}if(text){var message={user:user,text:text&&text.trim(),id:uuid.v4(),createdAt:new Date()};messages.push(message);}return messages;},[user,text,media]);var onSend=props.onSend;var send=useCallback(function(){if(messagesReadyToSend.length){if(onChangeText)onChangeText('');if(onChangeMedia)onChangeMedia([]);onSend(messagesReadyToSend);}},[onChangeText,onChangeMedia,messagesReadyToSend,onSend]);var textInputProps=props.textInputProps,renderTextInput=props.renderTextInput;var renderInput=useCallback(function(){if(renderTextInput===null)return null;var onSubmitEditing=function onSubmitEditing(){if(props.sendOnKeyboardReturn)send();};var inputProps={inputProps:textInputProps,onChangeText:onChangeText,text:text,containerStyle:props.inputContainerStyle,placeholderColor:props.placeholderColor,placeholderText:props.placeholderText,style:props.inputStyle,tintColor:props.tintColor,inputRef:props.inputRef,sendOnKeyboardReturn:props.sendOnKeyboardReturn,onSubmitEditing:onSubmitEditing};if(renderTextInput)return renderTextInput(inputProps);return React.createElement(Input,_extends({},inputProps,{__source:{fileName:_jsxFileName,lineNumber:107}}));},[onChangeText,text,textInputProps,renderTextInput,props.inputContainerStyle,props.placeholderColor,props.placeholderText,props.inputStyle,props.tintColor,props.inputRef,props.sendOnKeyboardReturn,send]);var renderSendButton=props.renderSendButton;var sendButtonMode=(_ref2=props.sendButtonMode==null?void 0:props.sendButtonMode({hasText:!!(text&&text.trim())}))!=null?_ref2:'icon';var renderSend=useCallback(function(){if(renderSendButton===null)return null;var sendProps={onSend:send,text:text,media:media,user:user,mode:sendButtonMode,containerStyle:props.sendButtonContainerStyle,tintColor:props.tintColor};if(renderSendButton)return renderSendButton(sendProps);return React.createElement(Send,_extends({},sendProps,{__source:{fileName:_jsxFileName,lineNumber:147}}));},[send,text,user,media,renderSendButton,sendButtonMode,props.sendButtonContainerStyle,props.tintColor]);var containerStyle=useMemo(function(){var paddingBottom=keyboardOpen&&isIphoneX()?10:getBottomSpace();return[styles.container,{paddingBottom:paddingBottom},props.containerStyle];},[props.containerStyle,keyboardOpen]);return React.createElement(View,{style:[containerStyle],__source:{fileName:_jsxFileName,lineNumber:165}},React.createElement(View,{style:styles.wrapper,__source:{fileName:_jsxFileName,lineNumber:166}},renderInput(),renderSend()));};Composer.displayName='Juice.Composer';export default React.memo(Composer);var styles=StyleSheet.create({container:{paddingBottom:10,paddingTop:5},wrapper:{flexDirection:'row',alignItems:'flex-end'}});
//# sourceMappingURL=index.js.map