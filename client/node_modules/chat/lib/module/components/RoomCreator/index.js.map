{"version":3,"sources":["index.tsx"],"names":["React","useMemo","useRef","useState","useEffect","BottomSheet","Header","Content","Animated","Value","useCode","block","cond","eq","call","and","initialSelected","RoomCreator","props","sheetRef","callbackNode","selectedState","setSelected","text","setText","ref","undefined","selected","ready","isReadyFunc","Object","keys","filter","Boolean","length","mounted","onDidClose","current","onDidOpen","reset","toggleSelected","id","onSelectItem","currentlySelected","user","users","find","u","pressed","ommitted","type","open","snapTo","close","creatorRef","renderHeader","headerProps","image","headerImage","imageStyle","headerImageStyle","subtitle","headerSubtitle","subtitleStyle","headerSubtitleStyle","title","headerTitle","titleStyle","headerTitleStyle","backgroundColor","headerBackgroundColor","containerStyle","headerContainerStyle","renderContent","contentProps","renderFooter","buttons","renderButton","ButtonComponent","renderItem","renderSelectedIcon","selectedIconActiveColor","selectedIconInactiveColor","enableTextInput","inputContainerStyle","inputStyle","showInputWhenNotReady","inputProps","onChangeText","snapPoints","initialSnap","startOpen","renderSheet","sheetProps"],"mappings":"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","sourcesContent":["import React, { useMemo, useRef, useState, useEffect } from 'react'\nimport BottomSheet from 'reanimated-bottom-sheet'\nimport Header from './Header'\nimport Content from './Content'\nimport Animated from 'react-native-reanimated'\nimport {\n\tRoomCreatorProps,\n\tSelected,\n\tRoomCreatorContentProps,\n\tRoomCreatorHeaderProps\n} from './types'\n\nconst { Value, useCode, block, cond, eq, call, and } = Animated\n\nconst initialSelected: Selected = {}\n\nfunction RoomCreator(props: RoomCreatorProps) {\n\tconst sheetRef = useRef<BottomSheet>(null)\n\tconst callbackNode = useMemo(() => props.callbackNode || new Value(1), [\n\t\tprops.callbackNode\n\t])\n\tconst [selectedState, setSelected] = useState<Selected>(initialSelected)\n\tconst [text, setText] = useState('')\n\n\tconst ref = props.sheetRef !== undefined ? props.sheetRef : sheetRef\n\n\t// should we handle selected state or not\n\tconst selected = props.selected || selectedState\n\n\tconst ready = useMemo(\n\t\t() =>\n\t\t\tprops.isReadyFunc\n\t\t\t\t? props.isReadyFunc(selected)\n\t\t\t\t: !!Object.keys(selected).filter(Boolean).length,\n\t\t[props, selected]\n\t)\n\n\tconst mounted = useRef(0)\n\n\tuseCode(\n\t\t() =>\n\t\t\tblock([\n\t\t\t\tcond(\n\t\t\t\t\t// if the sheet just opened\n\t\t\t\t\teq(callbackNode, 1),\n\t\t\t\t\tcall([], onDidClose),\n\t\t\t\t\t// if the sheet just closed\n\t\t\t\t\tcond(\n\t\t\t\t\t\tand(eq(callbackNode, 0), (mounted.current, 1)),\n\t\t\t\t\t\tcall([], onDidOpen)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t]),\n\t\t[callbackNode, onDidClose, onDidOpen]\n\t)\n\n\tuseEffect(() => {\n\t\tif (!mounted.current) mounted.current = 1\n\t}, [])\n\n\tfunction reset() {\n\t\tsetSelected(initialSelected)\n\t\tsetText('')\n\t}\n\n\tconst toggleSelected = (id: string) => {\n\t\tif (props.onSelectItem) return props.onSelectItem(id)\n\n\t\tsetSelected(currentlySelected => {\n\t\t\tconst user = props.users.find(u => u.id === id)\n\t\t\tif (currentlySelected[id] || !user) {\n\t\t\t\tconst { [id]: pressed, ...ommitted } = currentlySelected\n\t\t\t\treturn ommitted\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...currentlySelected,\n\t\t\t\t[id]: user.type\n\t\t\t}\n\t\t})\n\t}\n\n\tconst open = () => ref.current && ref.current.snapTo(1)\n\tconst close = () => ref.current && ref.current.snapTo(0)\n\n\tif (props.creatorRef) {\n\t\tprops.creatorRef.current = {\n\t\t\topen,\n\t\t\tclose\n\t\t}\n\t}\n\n\t// useEffect(() => {\n\t// \tif (props.isOpen === true) open()\n\t// \telse close()\n\t// }, [props.isOpen])\n\n\tfunction onDidClose() {\n\t\tif (props.onDidClose) props.onDidClose()\n\t\treset()\n\t}\n\n\tfunction onDidOpen() {\n\t\tif (props.onDidOpen) props.onDidOpen()\n\t}\n\n\tconst renderHeader = () => {\n\t\tconst headerProps: RoomCreatorHeaderProps = {\n\t\t\tcallbackNode,\n\t\t\timage: props.headerImage,\n\t\t\timageStyle: props.headerImageStyle,\n\t\t\tsubtitle: props.headerSubtitle,\n\t\t\tsubtitleStyle: props.headerSubtitleStyle,\n\t\t\ttitle: props.headerTitle || 'New Message',\n\t\t\ttitleStyle: props.headerTitleStyle,\n\t\t\tbackgroundColor: props.headerBackgroundColor || '#f8f8f8',\n\t\t\tcontainerStyle: props.headerContainerStyle\n\t\t}\n\t\tif (props.renderHeader) return props.renderHeader(headerProps)\n\t\tif (props.renderHeader === null) return null\n\n\t\treturn <Header {...headerProps} />\n\t}\n\n\tconst renderContent = () => {\n\t\tconst contentProps: RoomCreatorContentProps = {\n\t\t\ttoggleSelected,\n\t\t\tselected,\n\t\t\trenderFooter: props.renderFooter,\n\t\t\tbuttons: props.buttons,\n\t\t\trenderButton: props.renderButton,\n\t\t\tButtonComponent: props.ButtonComponent,\n\t\t\tusers: props.users,\n\t\t\trenderItem: props.renderItem,\n\t\t\tready,\n\t\t\trenderSelectedIcon: props.renderSelectedIcon,\n\t\t\tselectedIconActiveColor: props.selectedIconActiveColor,\n\t\t\tselectedIconInactiveColor: props.selectedIconInactiveColor,\n\t\t\tenableTextInput: props.enableTextInput,\n\t\t\tinputContainerStyle: props.inputContainerStyle,\n\t\t\tinputStyle: props.inputStyle,\n\t\t\tshowInputWhenNotReady: props.showInputWhenNotReady,\n\t\t\tinputProps: props.inputProps,\n\t\t\tonChangeText: setText,\n\t\t\ttext\n\t\t}\n\t\tif (props.renderContent) return props.renderContent(contentProps)\n\t\tif (props.renderContent === null) return null\n\n\t\treturn <Content {...contentProps} />\n\t}\n\n\tconst snapPoints = useMemo(() => props.snapPoints || ['0%', '90%'], [\n\t\tprops.snapPoints\n\t])\n\n\tconst initialSnap = props.startOpen ? 1 : 0\n\n\tconst renderSheet = () => {\n\t\treturn (\n\t\t\t<BottomSheet\n\t\t\t\t{...{ initialSnap }}\n\t\t\t\t{...props.sheetProps}\n\t\t\t\t{...{\n\t\t\t\t\trenderHeader,\n\t\t\t\t\trenderContent,\n\t\t\t\t\tsnapPoints,\n\t\t\t\t\tcallbackNode,\n\t\t\t\t\tref\n\t\t\t\t}}\n\t\t\t/>\n\t\t)\n\t}\n\n\treturn <>{renderSheet()}</>\n}\n\nexport default RoomCreator\n"]}