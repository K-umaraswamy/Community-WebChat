{"version":3,"sources":["index.tsx"],"names":["React","useRef","useEffect","Animated","StyleSheet","SafeAreaView","Item","Room","getInitials","Separator","Reanimated","Transitioning","Transition","props","transitionRef","numberOfRoomsWithUsersTyping","rooms","filter","room","getUsersTyping","length","enableRoomTransitions","current","animateNextTransition","scrollY","animatedScrollNode","Value","onScroll","event","nativeEvent","contentOffset","y","useNativeDriver","renderList","keyExtractor","item","index","id","toString","extraData","styles","contentContainer","separatorSize","separatorColor","flatListProps","renderItem","renderHeader","headerProps","big","bigHeader","onPressNewRoom","HeaderComponent","View","renderFooter","footerProps","FooterComponent","itemInfo","maxNumberOfInitials","lastMessage","members","unreadCount","name","roomName","roomNameFunc","getName","roomAvatar","avatar","initials","roomInitialsFunc","otherMembers","getArrayOfMembersOtherThanMe","prioritizeAvatarOverInitials","fallbackToMultipleAvatarsIfNoGroupAvatar","map","member","sort","a","b","onPress","pointerInside","onPressItem","console","log","onLongPress","onLongPressItem","itemProps","lastMessageCreatedAt","createdAt","lastMessageText","text","renderTitle","renderItemTitle","renderDate","renderItemDate","TitleComponent","ItemTitleComponent","titleStyle","titleContainerStyle","DateComponent","ItemDateComponent","unreadIndicatorColor","unreadTextColor","showUnreadIndicator","showUnreadIndicatorCount","UnreadIndicatorComponent","renderUnreadIndicator","unreadIndicatorStyle","unreadIndicatorTextStyle","unreadIndicatorPosition","unreadIndicatorPostion","dateToStringFunc","renderAvatar","renderInitials","renderSubtitle","renderItemSubtitle","SubtitleComponent","ItemSubtitleComponent","subtitleTextStyle","itemSubtitleTextStyle","AvatarComponent","ItemAvatarComponent","InitialsComponent","ItemInitialsComponent","avatarImageProps","avatarSize","initialsContainerStyle","initialsTextStyle","disableAvatar","initialsBackgroundColor","initialsTextColor","swipeable","swipeableRow","renderSwipeAction","swipeLeftActions","swipeRightActions","swipeActionWidth","backgroundColor","itemBackgroundColor","swipeableRowProps","unreadIndicatorType","unreadIndicatorGradientProps","unreadIndicatorSize","containerStyle","itemContainerStyle","dateStyle","renderLeftActions","renderRightActions","actionTextStyle","showTypingIndicator","renderTypingIndicator","numberOfPeopleTyping","renderItemWithProps","InboxItemComponent","Container","ContainerComponent","safeArea","createAnimatedComponent","containerStyles","container","transition","roomTransitionConfig","create","flex","flexGrow"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from 'react'\nimport {\n\tAnimated,\n\tListRenderItemInfo,\n\tStyleSheet,\n\tSafeAreaView\n} from 'react-native'\nimport InboxProps, { InboxMethodProps, InboxItemProps } from './types'\nimport { ExistingRoomModel } from '../../classes/Room/types'\nimport Item from './Item'\nimport Room from '../../classes/Room'\nimport { getInitials } from '../../helpers/getInitials'\nimport Separator from './Item/Separator'\nimport Reanimated, {\n\tTransitioning,\n\tTransition,\n\tTransitioningView\n} from 'react-native-reanimated'\n\nexport default function<InboxItem extends ExistingRoomModel>(\n\tprops: InboxProps<InboxItem>\n) {\n\t// \"constructor\" variables\n\n\t// used to shuffle/transition the inbox when it changes\n\tconst transitionRef = useRef<TransitioningView>(null)\n\n\tconst numberOfRoomsWithUsersTyping = (props.rooms || []).filter(\n\t\troom => new Room(room).getUsersTyping().length\n\t).length\n\n\tuseEffect(() => {\n\t\tif (props.enableRoomTransitions !== false && transitionRef.current)\n\t\t\ttransitionRef.current.animateNextTransition()\n\t}, [props.rooms, props.enableRoomTransitions, numberOfRoomsWithUsersTyping])\n\n\t// track animated position of scroll\n\tconst scrollY: Animated.Value =\n\t\tprops.animatedScrollNode || new Animated.Value(0)\n\n\t// upate position of scroll variable\n\tconst onScroll = Animated.event(\n\t\t[{ nativeEvent: { contentOffset: { y: scrollY } } }],\n\t\t{ useNativeDriver: true }\n\t)\n\n\t// render room list\n\tfunction renderList() {\n\t\t// give a unique key to each item (flatlist prop)\n\t\tfunction keyExtractor(item: InboxItem, index: number) {\n\t\t\treturn props.keyExtractor\n\t\t\t\t? props.keyExtractor(item, index)\n\t\t\t\t: (item && item.id) || index.toString()\n\t\t}\n\t\treturn (\n\t\t\t<Animated.FlatList\n\t\t\t\tonScroll={onScroll}\n\t\t\t\textraData={props.extraData}\n\t\t\t\tcontentContainerStyle={styles.contentContainer}\n\t\t\t\tItemSeparatorComponent={() => (\n\t\t\t\t\t<Separator size={props.separatorSize} color={props.separatorColor} />\n\t\t\t\t)}\n\t\t\t\t{...props.flatListProps}\n\t\t\t\tkeyExtractor={keyExtractor}\n\t\t\t\trenderItem={renderItem}\n\t\t\t\tdata={props.rooms}\n\t\t\t/>\n\t\t)\n\t}\n\n\t// optionally render header\n\tfunction renderHeader() {\n\t\tconst headerProps: InboxMethodProps<InboxItem>['renderHeader'] = {\n\t\t\tscrollY,\n\t\t\tbig: props.bigHeader !== false,\n\t\t\tonPressNewRoom: props.onPressNewRoom\n\t\t}\n\t\tif (props.renderHeader) return props.renderHeader(headerProps)\n\t\tif (props.renderHeader === null) return null\n\n\t\tconst HeaderComponent = props.HeaderComponent || Animated.View\n\n\t\treturn <HeaderComponent {...headerProps} />\n\t}\n\n\t// optionally render footer\n\tfunction renderFooter() {\n\t\tconst footerProps: InboxMethodProps<InboxItem>['renderFooter'] = {\n\t\t\tscrollY\n\t\t}\n\n\t\tif (props.renderFooter) return props.renderFooter(footerProps)\n\t\tif (props.renderFooter === null) return null\n\n\t\tconst FooterComponent = props.FooterComponent || Animated.View\n\n\t\treturn <FooterComponent {...footerProps} />\n\t}\n\n\t// flatlist methods\n\n\t// render each room item\n\tfunction renderItem(itemInfo: ListRenderItemInfo<InboxItem>) {\n\t\t// not sure why you'd wanna return null, but just in case...\n\t\tif (props.renderItem === null) return null\n\t\t// render item raw – without our constructed props\n\t\tif (props.renderItem) return props.renderItem(itemInfo)\n\n\t\tconst maxNumberOfInitials = props.maxNumberOfInitials || 2\n\n\t\tconst {\n\t\t\tlastMessage,\n\t\t\tmembers,\n\t\t\tid,\n\t\t\tunreadCount = 0,\n\t\t\tname: roomName = ''\n\t\t} = itemInfo.item\n\n\t\tconst room = new Room({ members, id, name: roomName })\n\n\t\tconst name = props.roomNameFunc\n\t\t\t? props.roomNameFunc({ members, name: roomName })\n\t\t\t: room.getName()\n\n\t\t// first check for a room avatar\n\t\tconst roomAvatar = itemInfo.item.avatar\n\n\t\t// either one image or an array\n\t\tlet avatar: InboxItemProps<InboxItem>['avatar'] = roomAvatar || ''\n\t\tconst initials: string = props.roomInitialsFunc\n\t\t\t? props.roomInitialsFunc({\n\t\t\t\t\tmembers,\n\t\t\t\t\tname,\n\t\t\t\t\tmaxNumberOfInitials\n\t\t\t  })\n\t\t\t: room.getInitials(maxNumberOfInitials)\n\n\t\tconst otherMembers = room.getArrayOfMembersOtherThanMe()\n\n\t\t/*\n\t\t\n\t\t\tThis next block of verbose code concerns itself with \n\t\t\tthe avatar / initials icon \n\t\t\n\t\t*/\n\n\t\t// if the room has no name, and we prefer to show avatars\n\t\t// then we want to get as close as we can to showing the avatar\n\t\tif (props.prioritizeAvatarOverInitials && !roomName) {\n\t\t\t// if there's currently no avatar\n\t\t\t// and only one member\n\t\t\t// then make the avatar that person's picture\n\t\t\tif (!avatar && otherMembers.length === 1 && otherMembers[0]) {\n\t\t\t\tavatar = (otherMembers[0] && otherMembers[0].avatar) || ''\n\t\t\t}\n\t\t\t// alternatively, if there are multiple people,\n\t\t\t// no room avatar,\n\t\t\t// and we want to show multiple avatars as a fallback\n\t\t\tif (\n\t\t\t\totherMembers.length > 1 &&\n\t\t\t\t!roomAvatar &&\n\t\t\t\tprops.fallbackToMultipleAvatarsIfNoGroupAvatar !== false\n\t\t\t) {\n\t\t\t\t// TODO something here is weird, this doesn't make sense\n\n\t\t\t\t// avatar then becomes an array which also includes the initials\n\t\t\t\t// for each member user, an array with this => { avatar, initials }\n\t\t\t\t// then, in the item component, if avatar is prioritized and existent, we render that\n\t\t\t\tavatar = otherMembers\n\t\t\t\t\t.map(member => ({\n\t\t\t\t\t\tinitials: getInitials(member.name, props.maxNumberOfInitials),\n\t\t\t\t\t\tavatar: member.avatar || ''\n\t\t\t\t\t}))\n\t\t\t\t\t.sort((a, b) => (a.avatar > b.avatar ? 1 : -1))\n\t\t\t}\n\t\t\t// 😅 glad that's done\n\t\t}\n\n\t\tconst onPress = (pointerInside?: boolean) =>\n\t\t\tprops.onPressItem\n\t\t\t\t? props.onPressItem(id, pointerInside)\n\t\t\t\t: console.log(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\t'pressed. change onPressItem prop on the <Inbox /> component to handle this function.'\n\t\t\t\t  )\n\n\t\tconst onLongPress = (pointerInside?: boolean) =>\n\t\t\tprops.onLongPressItem\n\t\t\t\t? props.onLongPressItem(id, pointerInside)\n\t\t\t\t: console.log(\n\t\t\t\t\t\t'long pressed ',\n\t\t\t\t\t\tid,\n\t\t\t\t\t\t'edit onLongPressItem prop to handle this function'\n\t\t\t\t  )\n\n\t\t// well those are some props.\n\t\t// each room receives these\n\t\t// most of them are passed directly from the parent component props\n\t\t// the ones marked <someprop>: props.<someprop> !== false are default true\n\t\tconst itemProps: InboxItemProps<InboxItem> = {\n\t\t\tlastMessageCreatedAt: lastMessage.createdAt,\n\t\t\tlastMessageText: lastMessage.text,\n\t\t\tavatar,\n\t\t\tname,\n\t\t\tinitials,\n\t\t\tonPress,\n\t\t\tunreadCount,\n\t\t\trenderTitle: props.renderItemTitle,\n\t\t\trenderDate: props.renderItemDate,\n\t\t\tTitleComponent: props.ItemTitleComponent,\n\t\t\ttitleStyle: props.titleStyle,\n\t\t\ttitleContainerStyle: props.titleContainerStyle,\n\t\t\tDateComponent: props.ItemDateComponent,\n\t\t\tunreadIndicatorColor: props.unreadIndicatorColor,\n\t\t\tunreadTextColor: props.unreadTextColor,\n\t\t\tshowUnreadIndicator: props.showUnreadIndicator !== false,\n\t\t\tshowUnreadIndicatorCount: props.showUnreadIndicatorCount !== false,\n\t\t\tUnreadIndicatorComponent: props.UnreadIndicatorComponent,\n\t\t\trenderUnreadIndicator: props.renderUnreadIndicator,\n\t\t\tunreadIndicatorStyle: props.unreadIndicatorStyle,\n\t\t\tunreadIndicatorTextStyle: props.unreadIndicatorTextStyle,\n\t\t\tunreadIndicatorPosition: props.unreadIndicatorPostion,\n\t\t\tdateToStringFunc: props.dateToStringFunc,\n\t\t\tonLongPress,\n\t\t\tprioritizeAvatarOverInitials:\n\t\t\t\tprops.prioritizeAvatarOverInitials !== false, // default true\n\t\t\trenderAvatar: props.renderAvatar,\n\t\t\trenderInitials: props.renderInitials,\n\t\t\trenderSubtitle: props.renderItemSubtitle,\n\t\t\tSubtitleComponent: props.ItemSubtitleComponent,\n\t\t\tsubtitleTextStyle: props.itemSubtitleTextStyle,\n\t\t\tAvatarComponent: props.ItemAvatarComponent,\n\t\t\tInitialsComponent: props.ItemInitialsComponent,\n\t\t\troomInitialsFunc: props.roomInitialsFunc,\n\t\t\tavatarImageProps: props.avatarImageProps,\n\t\t\tavatarSize: props.avatarSize,\n\t\t\tinitialsContainerStyle: props.initialsContainerStyle,\n\t\t\tinitialsTextStyle: props.initialsTextStyle,\n\t\t\tdisableAvatar: props.disableAvatar,\n\t\t\tinitialsBackgroundColor: props.initialsBackgroundColor,\n\t\t\tinitialsTextColor: props.initialsTextColor,\n\t\t\tswipeable: props.swipeableRow !== false,\n\t\t\tid,\n\t\t\trenderSwipeAction: props.renderSwipeAction,\n\t\t\tswipeLeftActions: props.swipeLeftActions,\n\t\t\tswipeRightActions: props.swipeRightActions,\n\t\t\tswipeActionWidth: props.swipeActionWidth,\n\t\t\tbackgroundColor: props.itemBackgroundColor || 'white',\n\t\t\tswipeableRowProps: props.swipeableRowProps,\n\t\t\tunreadIndicatorType: props.unreadIndicatorType,\n\t\t\tunreadIndicatorGradientProps: props.unreadIndicatorGradientProps,\n\t\t\tunreadIndicatorSize: props.unreadIndicatorSize,\n\t\t\tcontainerStyle: props.itemContainerStyle,\n\t\t\tdateStyle: props.dateStyle,\n\t\t\trenderLeftActions: props.renderLeftActions,\n\t\t\trenderRightActions: props.renderRightActions,\n\t\t\tactionTextStyle: props.actionTextStyle,\n\t\t\tshowTypingIndicator: props.showTypingIndicator !== false,\n\t\t\trenderTypingIndicator: props.renderTypingIndicator,\n\t\t\tnumberOfPeopleTyping: room.getUsersTyping().length\n\t\t}\n\n\t\t// if you want to use your own renderItem function, but include the props we made\n\t\t// the alternative is a normal props.renderItem() which gets the raw flatlist data\n\t\tif (props.renderItemWithProps) return props.renderItemWithProps(itemProps)\n\n\t\t// custom InboxItem component, or the one we used\n\t\tconst InboxItemComponent = props.InboxItemComponent || Item\n\t\treturn <InboxItemComponent {...itemProps} />\n\t}\n\n\t// component props\n\tconst Container =\n\t\tprops.ContainerComponent ||\n\t\t(props.safeArea\n\t\t\t? Reanimated.createAnimatedComponent(SafeAreaView)\n\t\t\t: Reanimated.View)\n\tconst containerStyles = [styles.container, props.containerStyle]\n\n\t// inbox shuffle transition config\n\tconst transition: InboxProps<\n\t\tInboxItem\n\t>['roomTransitionConfig'] = props.roomTransitionConfig || (\n\t\t<Transition.Together>\n\t\t\t<Transition.Change\n\t\t\t\tinterpolation=\"easeInOut\"\n\t\t\t\tdurationMs={400}\n\t\t\t\tpropagation=\"top\"\n\t\t\t/>\n\t\t</Transition.Together>\n\t)\n\n\treturn (\n\t\t<Transitioning.View\n\t\t\ttransition={transition}\n\t\t\tref={transitionRef}\n\t\t\tstyle={containerStyles}\n\t\t>\n\t\t\t<Container style={containerStyles}>\n\t\t\t\t{renderHeader()}\n\t\t\t\t{renderList()}\n\t\t\t\t{renderFooter()}\n\t\t\t</Container>\n\t\t</Transitioning.View>\n\t)\n}\n\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tflex: 1\n\t},\n\tcontentContainer: {\n\t\tflexGrow: 1\n\t}\n})\n"]}